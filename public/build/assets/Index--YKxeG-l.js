import{A as I}from"./AdminLayout-B9id1OaC.js";import{a as L,r as v,E as T,b as s,k as U,o as m,w as o,h as e,e as n,d as x,f as D,F as P,j as Q,t as r,i as p,Q as j,l as w}from"./app-CsZa9FYx.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"approvals-dark"},G={class:"header-card mb-6"},H={class:"text-caption muted"},K={class:"text-center"},M={class:"action-group"},W={key:0},X={class:"d-flex justify-end mt-4"},Y={class:"snapshot"},Z={class:"d-flex justify-end mt-4"},tt={__name:"Index",setup(et){var y,k;const _=L().props.value,f=v(_.approvals||{data:[],last_page:1}),i=v(((y=_.approvals)==null?void 0:y.current_page)||1),d=T({action:((k=_.filters)==null?void 0:k.action)||null}),A=[{title:"Requested",value:"requested"},{title:"Approved",value:"approved"},{title:"Rejected",value:"rejected"}],u=v(!1),b=v("");function q(){j.get(route("broadcast.approvals.index"),{action:d.action},{preserveState:!0,preserveScroll:!0})}function g(l){j.get(route("broadcast.approvals.index"),{page:l,action:d.action},{preserveState:!0,preserveScroll:!0})}function B(l){b.value=JSON.stringify(l.snapshot||l.campaign,null,2),u.value=!0}async function N(l){if(confirm(`Approve campaign "${l.campaign.name}" ?`))try{await w.post(route("broadcast.approvals.approve",{approval:l.id})),g(i.value)}catch{alert("Error approving")}}async function R(l){const t=prompt("Reason for rejection:");if(t!==null)try{await w.post(route("broadcast.approvals.reject",{approval:l.id}),{note:t}),g(i.value)}catch{alert("Error rejecting")}}return(l,t)=>{const $=s("v-select"),c=s("v-btn"),E=s("v-table"),V=s("v-card"),F=s("v-pagination"),z=s("v-dialog");return m(),U(I,null,{title:o(()=>t[4]||(t[4]=[p("Broadcast Approvals")])),default:o(()=>[e("div",O,[e("div",G,[t[5]||(t[5]=e("div",null,[e("h3",null,"Broadcast Approval Requests"),e("p",null,"Pending approvals for broadcast campaigns")],-1)),n($,{modelValue:d.action,"onUpdate:modelValue":[t[0]||(t[0]=a=>d.action=a),q],items:A,label:"Filter Status",clearable:"",density:"compact",style:{width:"200px"}},null,8,["modelValue"])]),n(V,{class:"card pa-0"},{default:o(()=>[n(E,null,{default:o(()=>[t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th",null,"Campaign"),e("th",null,"Requested By"),e("th",null,"Notes"),e("th",null,"Snapshot"),e("th",null,"Requested At"),e("th",{class:"text-center"},"Action")])],-1)),e("tbody",null,[(m(!0),x(P,null,Q(f.value.data,a=>{var h,C;return m(),x("tr",{key:a.id,class:"row-hover"},[e("td",null,[e("strong",null,r(a.campaign.name),1),e("div",H," Template: "+r(((h=a.campaign.template)==null?void 0:h.name)||"-"),1)]),e("td",null,r(((C=a.requester)==null?void 0:C.name)||"â€”"),1),e("td",null,r(a.request_notes||"-"),1),e("td",null,[n(c,{size:"small",variant:"text",class:"link-btn",onClick:S=>B(a)},{default:o(()=>t[6]||(t[6]=[p(" View ")])),_:2,__:[6]},1032,["onClick"])]),e("td",null,r(new Date(a.created_at).toLocaleString()),1),e("td",K,[e("div",M,[n(c,{size:"small",class:"approve-btn",onClick:S=>N(a)},{default:o(()=>t[7]||(t[7]=[p(" Approve ")])),_:2,__:[7]},1032,["onClick"]),n(c,{size:"small",class:"reject-btn",onClick:S=>R(a)},{default:o(()=>t[8]||(t[8]=[p(" Reject ")])),_:2,__:[8]},1032,["onClick"])])])])}),128)),f.value.data.length===0?(m(),x("tr",W,t[9]||(t[9]=[e("td",{colspan:"6",class:"text-center muted pa-6"}," No approval requests. ",-1)]))):D("",!0)])]),_:1,__:[10]})]),_:1}),e("div",X,[n(F,{modelValue:i.value,"onUpdate:modelValue":[t[1]||(t[1]=a=>i.value=a),g],length:f.value.last_page},null,8,["modelValue","length"])]),n(z,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=a=>u.value=a),"max-width":"820"},{default:o(()=>[n(V,{class:"card pa-4"},{default:o(()=>[t[12]||(t[12]=e("h3",{class:"mb-3"},"Snapshot",-1)),e("pre",Y,""+r(b.value)+`
          `,1),e("div",Z,[n(c,{variant:"text",onClick:t[2]||(t[2]=a=>u.value=!1)},{default:o(()=>t[11]||(t[11]=[p(" Close ")])),_:1,__:[11]})])]),_:1,__:[12]})]),_:1},8,["modelValue"])])]),_:1})}}},nt=J(tt,[["__scopeId","data-v-e1995313"]]);export{nt as default};
