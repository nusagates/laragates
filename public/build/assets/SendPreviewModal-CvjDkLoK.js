import{r as c,b as l,f as O,o as P,w as m,e as o,i as p,j as g,t as U,l as k}from"./app-8P1lhKkM.js";const B={class:"text-subtitle-2 mb-1"},j={class:"d-flex justify-end mt-5",style:{gap:"12px"}},T={__name:"SendPreviewModal",props:{modelValue:Boolean,template:Object},emits:["update:modelValue"],setup(V,{emit:x}){const d=V,b=x,t=c({phone:"",language:"id",components:[]}),i=c(!1),v=c({});function f(){b("update:modelValue",!1)}function y(n){var e;return((e=v.value[n])==null?void 0:e[0])||""}async function w(){var n,e,r;i.value=!0,v.value={};try{const a=await k.post(route("templates.send-preview",d.template.id),{phone:t.value.phone,language:t.value.language,components:t.value.components});alert(`Preview sent (SIMULATION OK):
`+a.data.message),f()}catch(a){((n=a.response)==null?void 0:n.status)===422?v.value=a.response.data.errors:alert("Send failed: "+(((r=(e=a.response)==null?void 0:e.data)==null?void 0:r.message)||a.message))}finally{i.value=!1}}return(n,e)=>{const r=l("v-text-field"),a=l("v-select"),S=l("v-textarea"),_=l("v-btn"),C=l("v-card"),N=l("v-dialog");return P(),O(N,{modelValue:d.modelValue,"onUpdate:modelValue":e[3]||(e[3]=u=>d.modelValue=u),"max-width":"500px"},{default:m(()=>[o(C,{class:"pa-4"},{default:m(()=>{var u;return[e[7]||(e[7]=p("h3",{class:"text-h6 font-weight-bold mb-3"}," Send Preview ",-1)),p("div",B,[e[4]||(e[4]=g(" Template: ")),p("strong",null,U((u=d.template)==null?void 0:u.name),1)]),o(r,{modelValue:t.value.phone,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.phone=s),label:"Phone (e.g. 628123...)",density:"compact",class:"mt-3","error-messages":y("phone")},null,8,["modelValue","error-messages"]),o(a,{modelValue:t.value.language,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.language=s),items:["id","en"],label:"Language",density:"compact",class:"mt-3"},null,8,["modelValue"]),o(S,{modelValue:t.value.components,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.components=s),label:"Optional components JSON",placeholder:'[{"type":"body","parameters":[{"type":"text","text":"Hello"}]}]',"auto-grow":"",class:"mt-3"},null,8,["modelValue"]),p("div",j,[o(_,{variant:"text",onClick:f},{default:m(()=>e[5]||(e[5]=[g("Cancel")])),_:1,__:[5]}),o(_,{color:"primary",loading:i.value,onClick:w},{default:m(()=>e[6]||(e[6]=[g(" Send ")])),_:1,__:[6]},8,["loading"])])]}),_:1,__:[7]})]),_:1},8,["modelValue"])}}};export{T as default};
