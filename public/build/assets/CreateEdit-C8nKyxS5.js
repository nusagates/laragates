import{A as D}from"./AdminLayout-B9id1OaC.js";import{r as U,a as G,m as I,c as f,b as d,d as m,o as r,e as a,u as S,g as J,w as o,h as i,t as p,Q as L,i as b,f as V,F as C,j as $,k as M,l as j}from"./app-CsZa9FYx.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"template-form-dark"},q={class:"text-h6 mb-4"},K={class:"d-flex justify-end gap-2 mt-5"},R={key:0},W={class:"wa-preview mt-4"},X={class:"wa-bubble"},Y={key:0,class:"wa-header"},Z={class:"wa-body"},ee={key:1,class:"wa-footer"},te={key:2,class:"wa-buttons"},ae={__name:"CreateEdit",setup(le){const v=U(!1),s=G().props.template||null,t=U({name:"",category:"",language:"id",header:"",body:"",footer:"",buttons:[]}),y=U({});I(()=>{s&&(v.value=!0,t.value={name:s.name,category:s.category,language:s.language,header:s.header,body:s.body,footer:s.footer,buttons:s.buttons??[]})});function g(n){const e=n==null?void 0:n.match(/\{(\d+)\}/g);return e?[...new Set(e.map(u=>u.replace("{","").replace("}","")))]:[]}const w=f(()=>{const n=new Set([...g(t.value.header),...g(t.value.body),...g(t.value.footer)]);return Array.from(n)});function k(n){if(!n)return"";let e=n;return w.value.forEach(u=>{const _=`{${u}}`;e=e.replaceAll(_,y.value[u]||_)}),e}const T=f(()=>k(t.value.header)),H=f(()=>k(t.value.body)),E=f(()=>k(t.value.footer));async function Q(){try{v.value&&s.id?(await j.put(`/templates/${s.id}`,t.value),alert("Template updated")):(await j.post("/templates",t.value),alert("Template created")),L.visit("/templates")}catch(n){console.error(n),alert("Failed to save")}}return(n,e)=>{const u=d("v-text-field"),_=d("v-select"),N=d("v-textarea"),B=d("v-btn"),A=d("v-card"),h=d("v-col"),F=d("v-row"),z=d("v-chip");return r(),m(C,null,[a(S(J),{title:v.value?"Edit Template":"New Template"},null,8,["title"]),a(D,null,{title:o(()=>[b(p(v.value?"Edit Template":"New Template"),1)]),default:o(()=>[i("div",P,[a(F,null,{default:o(()=>[a(h,{cols:"12",md:"6"},{default:o(()=>[a(A,{class:"dark-card pa-5"},{default:o(()=>[i("h3",q,p(v.value?"Edit Template":"Create New Template"),1),a(u,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),label:"Template Name"},null,8,["modelValue"]),a(_,{modelValue:t.value.category,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.category=l),label:"Category",items:["Utility","Marketing","Authentication"]},null,8,["modelValue"]),a(_,{modelValue:t.value.language,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.language=l),label:"Language",items:["id","en"]},null,8,["modelValue"]),a(u,{modelValue:t.value.header,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.header=l),label:"Header (optional)"},null,8,["modelValue"]),a(N,{modelValue:t.value.body,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.body=l),label:"Body Message",rows:"5",hint:"Gunakan {1}, {2} sebagai variable","persistent-hint":""},null,8,["modelValue"]),a(u,{modelValue:t.value.footer,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.footer=l),label:"Footer (optional)"},null,8,["modelValue"]),a(N,{modelValue:t.value.buttons,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.buttons=l),label:"Buttons JSON (optional)",hint:'Example: [{"type":"url","text":"Visit","url":"https://..."}]',rows:"3","persistent-hint":""},null,8,["modelValue"]),i("div",K,[a(B,{variant:"text",onClick:e[7]||(e[7]=l=>S(L).visit("/templates"))},{default:o(()=>e[8]||(e[8]=[b(" Cancel ")])),_:1,__:[8]}),a(B,{color:"primary",onClick:Q},{default:o(()=>[b(p(v.value?"Update":"Save"),1)]),_:1})])]),_:1})]),_:1}),a(h,{cols:"12",md:"6"},{default:o(()=>[a(A,{class:"dark-card pa-5"},{default:o(()=>{var l;return[e[10]||(e[10]=i("h3",{class:"text-h6 mb-4"},"Live Preview",-1)),w.value.length?(r(),m("div",R,[e[9]||(e[9]=i("h4",{class:"text-subtitle-2 mb-2 text-muted"},"Variables",-1)),a(F,null,{default:o(()=>[(r(!0),m(C,null,$(w.value,c=>(r(),M(h,{cols:"12",md:"6",key:c},{default:o(()=>[a(u,{modelValue:y.value[c],"onUpdate:modelValue":x=>y.value[c]=x,label:`Value for {${c}}`,density:"compact"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:1})])):V("",!0),i("div",W,[i("div",X,[T.value?(r(),m("p",Y,p(T.value),1)):V("",!0),i("p",Z,p(H.value),1),E.value?(r(),m("p",ee,p(E.value),1)):V("",!0),(l=t.value.buttons)!=null&&l.length?(r(),m("div",te,[(r(!0),m(C,null,$(t.value.buttons,(c,x)=>(r(),M(z,{key:x,size:"small",color:"blue-darken-2",label:""},{default:o(()=>[b(p(c.text||"Button"),1)]),_:2},1024))),128))])):V("",!0)])])]}),_:1,__:[10]})]),_:1})]),_:1})])]),_:1})],64)}}},re=O(ae,[["__scopeId","data-v-bda26236"]]);export{re as default};
