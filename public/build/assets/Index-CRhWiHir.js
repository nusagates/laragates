import{A as ne}from"./AdminLayout-O7Oxasoz.js";import{r as v,m as ue,b as V,d as J,o as c,e as a,u as se,g as de,w as n,i as o,j as d,h as L,F as q,k as re,t as p,f as O,l as b}from"./app-BqckiNoC.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                    */const me={class:"d-flex justify-space-between mb-4"},ve={class:"d-flex"},pe={class:"text-center"},fe={key:0},be={class:"d-flex justify-end mt-3"},ge={class:"d-flex justify-end mt-3"},ye={class:"d-flex justify-space-between mb-3"},Ve={class:"text-h6"},ce={class:"text-caption"},_e={class:"wa-bubble"},xe=["innerHTML"],we={key:0,class:"wa-bubble-footer"},ke={class:"d-flex justify-end mt-4"},Ce={class:"mb-3"},Ue={class:"text-caption"},Se={class:"d-flex justify-end mt-4"},Ae={__name:"Index",setup($e){const C=v([]),M=v(!1),U=v(!1),w=v(!1),_=v(!1),S=v(!1),s=v(null),u=v({name:"",category:"Utility",language:"id",header:"",body:"",footer:"",buttons:null}),m=v({to:"",language:"",componentsJson:""}),j=v(!1),i=v(!1),E=t=>{if(!t)return"grey";const e=t.toLowerCase();return{approved:"green",submitted:"blue",draft:"grey",rejected:"red",pending:"orange"}[e]||"grey"};function z(t){try{return JSON.parse(t)}catch{return null}}function K(t){if(!t)return"-";try{return new Date(t).toLocaleString()}catch{return t}}async function g(){M.value=!0;try{const t=await b.get("/templates-list");C.value=Array.isArray(t.data)?t.data:[]}catch{try{const e=await b.get("/templates/all");C.value=Array.isArray(e.data)?e.data:[]}catch{C.value=[]}}M.value=!1}async function F(){j.value=!0;try{const t={...u.value};typeof t.buttons=="string"&&t.buttons.trim()&&(t.buttons=z(t.buttons)||t.buttons),w.value?await b.put(`/templates/${s.value.id}`,t):await b.post("/templates",t),U.value=!1,w.value=!1,await g()}catch{alert("Failed to save template")}j.value=!1}async function G(t){if(confirm("Delete template?")){i.value=!0;try{await b.delete(`/templates/${t}`),await g()}catch{alert("Delete failed")}i.value=!1}}async function Q(t){if(confirm("Sync template?")){i.value=!0;try{await b.post(`/templates/${t}/sync`),await g(),alert("Synced")}catch{alert("Sync failed")}i.value=!1}}async function X(t){if(confirm("Submit for approval?")){i.value=!0;try{await b.post(`/templates/${t}/submit`),_.value=!1,await g()}catch{alert("Submit failed")}i.value=!1}}async function Y(t){if(confirm("Approve template?")){i.value=!0;try{await b.post(`/templates/${t}/approve`),_.value=!1,await g()}catch{alert("Approve failed")}i.value=!1}}async function Z(t){const e=prompt("Reason:");if(e){i.value=!0;try{await b.post(`/templates/${t}/reject`,{reason:e}),_.value=!1,await g()}catch{alert("Reject failed")}i.value=!1}}function h(t){s.value=t,m.value={to:"",language:t.language||"id",componentsJson:""},S.value=!0}async function ee(){if(!m.value.to){alert("Phone number required");return}i.value=!0;try{const t={to:m.value.to,language:m.value.language};m.value.componentsJson.trim()&&(t.components=JSON.parse(m.value.componentsJson)),await b.post(`/templates/${s.value.id}/send`,t),alert("Sent (check logs/provider)."),S.value=!1,await g()}catch{alert("Send failed")}i.value=!1}function le(){U.value=!0,u.value={name:"",category:"Utility",language:"id",header:"",body:"",footer:"",buttons:null}}function te(t){s.value=t,w.value=!0,u.value={name:t.name,category:t.category,language:t.language,header:t.header,body:t.body,footer:t.footer,buttons:t.buttons?JSON.stringify(t.buttons,null,2):null}}function ae(t){s.value=t,_.value=!0}return ue(g),(t,e)=>{const r=V("v-btn"),D=V("v-chip"),A=V("v-icon"),oe=V("v-table"),$=V("v-card"),x=V("v-text-field"),T=V("v-select"),N=V("v-textarea"),B=V("v-dialog");return c(),J(q,null,[a(se(de),{title:"Templates"}),a(ne,null,{title:n(()=>e[28]||(e[28]=[d("Templates")])),default:n(()=>[a($,{elevation:"3",class:"pa-4"},{default:n(()=>[o("div",me,[e[31]||(e[31]=o("div",null,[o("h3",{class:"text-h6"},"WhatsApp Templates"),o("p",{class:"text-body-2"},"Kelola template dan sync ke Meta API.")],-1)),o("div",ve,[a(r,{color:"primary","prepend-icon":"mdi-sync",onClick:g,loading:M.value},{default:n(()=>e[29]||(e[29]=[d("Refresh")])),_:1,__:[29]},8,["loading"]),a(r,{color:"primary","prepend-icon":"mdi-plus",onClick:le,class:"ml-2"},{default:n(()=>e[30]||(e[30]=[d(" NEW TEMPLATE ")])),_:1,__:[30]})])]),a(oe,{"fixed-header":"",height:"420"},{default:n(()=>[e[38]||(e[38]=o("thead",null,[o("tr",null,[o("th",null,"Name"),o("th",null,"Category"),o("th",null,"Lang"),o("th",null,"Status"),o("th",null,"Updated"),o("th",{class:"text-center"},"Action")])],-1)),o("tbody",null,[(c(!0),J(q,null,re(C.value,l=>(c(),J("tr",{key:l.id},[o("td",null,p(l.name),1),o("td",null,p(l.category),1),o("td",null,p(l.language),1),o("td",null,[a(D,{color:E(l.status),class:"text-white",size:"small"},{default:n(()=>[d(p(l.status),1)]),_:2},1032,["color"])]),o("td",null,p(K(l.updated_at)),1),o("td",pe,[a(r,{icon:"",variant:"text",onClick:f=>ae(l)},{default:n(()=>[a(A,null,{default:n(()=>e[32]||(e[32]=[d("mdi-eye")])),_:1,__:[32]})]),_:2},1032,["onClick"]),a(r,{icon:"",variant:"text",onClick:f=>te(l)},{default:n(()=>[a(A,null,{default:n(()=>e[33]||(e[33]=[d("mdi-pencil")])),_:1,__:[33]})]),_:2},1032,["onClick"]),a(r,{icon:"",color:"blue",variant:"flat",onClick:f=>Q(l.id)},{default:n(()=>[a(A,null,{default:n(()=>e[34]||(e[34]=[d("mdi-sync")])),_:1,__:[34]})]),_:2},1032,["onClick"]),a(r,{icon:"",color:"teal",variant:"flat",onClick:f=>h(l)},{default:n(()=>[a(A,null,{default:n(()=>e[35]||(e[35]=[d("mdi-send")])),_:1,__:[35]})]),_:2},1032,["onClick"]),a(r,{icon:"",color:"red",variant:"flat",onClick:f=>G(l.id)},{default:n(()=>[a(A,null,{default:n(()=>e[36]||(e[36]=[d("mdi-delete")])),_:1,__:[36]})]),_:2},1032,["onClick"])])]))),128)),C.value.length?L("",!0):(c(),J("tr",fe,e[37]||(e[37]=[o("td",{colspan:"6",class:"text-center pa-4"},"No templates",-1)])))])]),_:1,__:[38]})]),_:1}),a(B,{modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=l=>U.value=l),"max-width":"640"},{default:n(()=>[a($,{class:"pa-4"},{default:n(()=>[e[41]||(e[41]=o("h3",{class:"text-h6 mb-3"},"Add Template",-1)),a(x,{modelValue:u.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value.name=l),label:"Name",dense:"",class:"mb-3"},null,8,["modelValue"]),a(T,{modelValue:u.value.category,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value.category=l),items:["Utility","Marketing","Authentication"],label:"Category",dense:"",class:"mb-3"},null,8,["modelValue"]),a(T,{modelValue:u.value.language,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value.language=l),items:["id","en"],label:"Language",dense:"",class:"mb-3"},null,8,["modelValue"]),a(x,{modelValue:u.value.header,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.header=l),label:"Header",dense:"",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:u.value.body,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value.body=l),label:"Body",rows:"4",dense:"",class:"mb-3"},null,8,["modelValue"]),a(x,{modelValue:u.value.footer,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value.footer=l),label:"Footer",dense:"",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:u.value.buttons,"onUpdate:modelValue":e[6]||(e[6]=l=>u.value.buttons=l),label:"Buttons JSON",rows:"3",dense:"",class:"mb-3"},null,8,["modelValue"]),o("div",be,[a(r,{variant:"text",onClick:e[7]||(e[7]=l=>U.value=!1)},{default:n(()=>e[39]||(e[39]=[d("Cancel")])),_:1,__:[39]}),a(r,{color:"primary",loading:j.value,onClick:F},{default:n(()=>e[40]||(e[40]=[d("Save")])),_:1,__:[40]},8,["loading"])])]),_:1,__:[41]})]),_:1},8,["modelValue"]),a(B,{modelValue:w.value,"onUpdate:modelValue":e[17]||(e[17]=l=>w.value=l),"max-width":"640"},{default:n(()=>[a($,{class:"pa-4"},{default:n(()=>[e[44]||(e[44]=o("h3",{class:"text-h6 mb-3"},"Edit Template",-1)),a(x,{modelValue:u.value.name,"onUpdate:modelValue":e[9]||(e[9]=l=>u.value.name=l),label:"Name",dense:"",class:"mb-3"},null,8,["modelValue"]),a(T,{modelValue:u.value.category,"onUpdate:modelValue":e[10]||(e[10]=l=>u.value.category=l),items:["Utility","Marketing","Authentication"],label:"Category",dense:"",class:"mb-3"},null,8,["modelValue"]),a(T,{modelValue:u.value.language,"onUpdate:modelValue":e[11]||(e[11]=l=>u.value.language=l),items:["id","en"],label:"Language",dense:"",class:"mb-3"},null,8,["modelValue"]),a(x,{modelValue:u.value.header,"onUpdate:modelValue":e[12]||(e[12]=l=>u.value.header=l),label:"Header",dense:"",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:u.value.body,"onUpdate:modelValue":e[13]||(e[13]=l=>u.value.body=l),label:"Body",rows:"4",dense:"",class:"mb-3"},null,8,["modelValue"]),a(x,{modelValue:u.value.footer,"onUpdate:modelValue":e[14]||(e[14]=l=>u.value.footer=l),label:"Footer",dense:"",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:u.value.buttons,"onUpdate:modelValue":e[15]||(e[15]=l=>u.value.buttons=l),label:"Buttons JSON",rows:"3",dense:"",class:"mb-3"},null,8,["modelValue"]),o("div",ge,[a(r,{variant:"text",onClick:e[16]||(e[16]=l=>w.value=!1)},{default:n(()=>e[42]||(e[42]=[d("Cancel")])),_:1,__:[42]}),a(r,{color:"primary",loading:j.value,onClick:F},{default:n(()=>e[43]||(e[43]=[d("Update")])),_:1,__:[43]},8,["loading"])])]),_:1,__:[44]})]),_:1},8,["modelValue"]),a(B,{modelValue:_.value,"onUpdate:modelValue":e[22]||(e[22]=l=>_.value=l),"max-width":"720"},{default:n(()=>[a($,{class:"pa-4"},{default:n(()=>{var l,f,y,P,H,I,R,W;return[o("div",ye,[o("div",null,[o("h3",Ve,p((l=s.value)==null?void 0:l.name),1),o("p",ce,p((f=s.value)==null?void 0:f.category),1)]),a(D,{color:E((y=s.value)==null?void 0:y.status),class:"text-white"},{default:n(()=>{var k;return[d(p((k=s.value)==null?void 0:k.status),1)]}),_:1},8,["color"])]),o("div",_e,[o("div",{class:"wa-bubble-body",innerHTML:(P=s.value)==null?void 0:P.body},null,8,xe),(H=s.value)!=null&&H.footer?(c(),J("div",we,p(s.value.footer),1)):L("",!0)]),o("div",ke,[((I=s.value)==null?void 0:I.status)==="draft"?(c(),O(r,{key:0,color:"blue",onClick:e[18]||(e[18]=k=>X(s.value.id))},{default:n(()=>e[45]||(e[45]=[d(" Submit ")])),_:1,__:[45]})):L("",!0),((R=s.value)==null?void 0:R.status)==="submitted"?(c(),O(r,{key:1,color:"green",onClick:e[19]||(e[19]=k=>Y(s.value.id))},{default:n(()=>e[46]||(e[46]=[d(" Approve ")])),_:1,__:[46]})):L("",!0),((W=s.value)==null?void 0:W.status)==="submitted"?(c(),O(r,{key:2,color:"red",onClick:e[20]||(e[20]=k=>Z(s.value.id))},{default:n(()=>e[47]||(e[47]=[d(" Reject ")])),_:1,__:[47]})):L("",!0),a(r,{variant:"text",onClick:e[21]||(e[21]=k=>_.value=!1)},{default:n(()=>e[48]||(e[48]=[d("Close")])),_:1,__:[48]})])]}),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:S.value,"onUpdate:modelValue":e[27]||(e[27]=l=>S.value=l),"max-width":"600"},{default:n(()=>[a($,{class:"pa-4"},{default:n(()=>{var l,f;return[e[51]||(e[51]=o("h3",{class:"text-h6 mb-2"},"Send Template",-1)),o("div",Ce,[o("strong",null,p((l=s.value)==null?void 0:l.name),1),o("span",Ue,"("+p((f=s.value)==null?void 0:f.language)+")",1)]),a(x,{modelValue:m.value.to,"onUpdate:modelValue":e[23]||(e[23]=y=>m.value.to=y),label:"Phone (e.g. 628123123123)",dense:"",class:"mb-3"},null,8,["modelValue"]),a(T,{modelValue:m.value.language,"onUpdate:modelValue":e[24]||(e[24]=y=>m.value.language=y),items:["id","en"],label:"Language",dense:"",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:m.value.componentsJson,"onUpdate:modelValue":e[25]||(e[25]=y=>m.value.componentsJson=y),label:"Optional components JSON",rows:"4",dense:""},null,8,["modelValue"]),o("div",Se,[a(r,{variant:"text",onClick:e[26]||(e[26]=y=>S.value=!1)},{default:n(()=>e[49]||(e[49]=[d("Cancel")])),_:1,__:[49]}),a(r,{color:"primary",loading:i.value,onClick:ee},{default:n(()=>e[50]||(e[50]=[d(" Send ")])),_:1,__:[50]},8,["loading"])])]}),_:1,__:[51]})]),_:1},8,["modelValue"])]),_:1})],64)}}},je=ie(Ae,[["__scopeId","data-v-c6513af9"]]);export{je as default};
