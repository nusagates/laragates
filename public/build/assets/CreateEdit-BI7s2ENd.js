import{A as G}from"./AdminLayout-O7Oxasoz.js";import{r as k,a as J,m as O,c as b,b as r,d as m,o as d,e as a,u as F,g as P,w as o,i,t as p,Q as S,j as f,h as _,F as U,k as L,f as $,l as M}from"./app-BqckiNoC.js";/* empty css                                                                    */import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"text-h6 font-weight-bold mb-4"},I={class:"d-flex justify-end gap-2 mt-4"},K={key:0},R={style:{background:"#dcf8c6",padding:"14px 16px","border-radius":"12px","max-width":"90%","font-size":"15px","line-height":"1.4"}},W={key:0},X={style:{"white-space":"pre-line"}},Y={key:1,class:"text-grey-darken-1 text-caption"},Z={key:2,class:"mt-2"},se={__name:"CreateEdit",setup(ee){const v=k(!1),s=J().props.template||null,t=k({name:"",category:"",language:"id",header:"",body:"",footer:"",buttons:[]}),g=k({});O(()=>{s&&(v.value=!0,t.value={name:s.name,category:s.category,language:s.language,header:s.header,body:s.body,footer:s.footer,buttons:s.buttons??[]})});function y(n){const e=n==null?void 0:n.match(/\{(\d+)\}/g);return e?[...new Set(e.map(u=>u.replace("{","").replace("}","")))]:[]}const V=b(()=>{const n=new Set([...y(t.value.header),...y(t.value.body),...y(t.value.footer)]);return Array.from(n)});function h(n){if(!n)return"";let e=n;return V.value.forEach(u=>{const c=`{${u}}`;e=e.replaceAll(c,g.value[u]||c)}),e}const T=b(()=>h(t.value.header)),j=b(()=>h(t.value.body)),C=b(()=>h(t.value.footer));async function H(){try{v.value&&s.id?(await M.put(`/templates/${s.id}`,t.value),alert("Template updated")):(await M.post("/templates",t.value),alert("Template created")),S.visit("/templates")}catch(n){console.error(n),alert("Failed to save")}}return(n,e)=>{const u=r("v-text-field"),c=r("v-select"),N=r("v-textarea"),B=r("v-btn"),E=r("v-card"),w=r("v-col"),A=r("v-row"),Q=r("v-chip"),z=r("v-sheet");return d(),m(U,null,[a(F(P),{title:v.value?"Edit Template":"New Template"},null,8,["title"]),a(G,null,{title:o(()=>[f(p(v.value?"Edit Template":"New Template"),1)]),default:o(()=>[a(A,null,{default:o(()=>[a(w,{cols:"12",md:"6"},{default:o(()=>[a(E,{class:"pa-4",elevation:"2"},{default:o(()=>[i("h3",q,p(v.value?"Edit Template":"Create New Template"),1),a(u,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),label:"Template Name",class:"mb-3"},null,8,["modelValue"]),a(c,{modelValue:t.value.category,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.category=l),label:"Category",items:["Utility","Marketing","Authentication"],class:"mb-3"},null,8,["modelValue"]),a(c,{modelValue:t.value.language,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.language=l),label:"Language",items:["id","en"],class:"mb-3"},null,8,["modelValue"]),a(u,{modelValue:t.value.header,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.header=l),label:"Header (optional)",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:t.value.body,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.body=l),label:"Body Message",rows:"5",hint:"Gunakan {1}, {2} sebagai variable",class:"mb-3"},null,8,["modelValue"]),a(u,{modelValue:t.value.footer,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.footer=l),label:"Footer (optional)",class:"mb-3"},null,8,["modelValue"]),a(N,{modelValue:t.value.buttons,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.buttons=l),label:"Buttons JSON (optional)",hint:'Example: [{"type":"url","text":"Visit","url":"https://..."}]',rows:"3",class:"mb-3"},null,8,["modelValue"]),i("div",I,[a(B,{variant:"text",onClick:e[7]||(e[7]=l=>F(S).visit("/templates"))},{default:o(()=>e[8]||(e[8]=[f("Cancel")])),_:1,__:[8]}),a(B,{color:"primary",onClick:H},{default:o(()=>[f(p(v.value?"Update":"Save"),1)]),_:1})])]),_:1})]),_:1}),a(w,{cols:"12",md:"6"},{default:o(()=>[a(E,{class:"pa-4",elevation:"2"},{default:o(()=>[e[10]||(e[10]=i("h3",{class:"text-h6 font-weight-bold mb-4"},"Live Preview",-1)),V.value.length?(d(),m("div",K,[e[9]||(e[9]=i("h4",{class:"text-subtitle-2 mb-2"},"Variables",-1)),a(A,null,{default:o(()=>[(d(!0),m(U,null,L(V.value,l=>(d(),$(w,{cols:"12",md:"6",key:l},{default:o(()=>[a(u,{modelValue:g.value[l],"onUpdate:modelValue":x=>g.value[l]=x,label:`Value for {${l}}`,class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:1})])):_("",!0),a(z,{elevation:"1",class:"pa-4 mt-4",style:{background:"#ece5dd","border-radius":"12px"}},{default:o(()=>{var l;return[i("div",R,[T.value?(d(),m("p",W,[i("b",null,p(T.value),1)])):_("",!0),i("p",X,p(j.value),1),C.value?(d(),m("p",Y,p(C.value),1)):_("",!0),(l=t.value.buttons)!=null&&l.length?(d(),m("div",Z,[(d(!0),m(U,null,L(t.value.buttons,(x,D)=>(d(),$(Q,{key:D,class:"ma-1",color:"blue",label:"",small:""},{default:o(()=>[f(p(x.text||"Button"),1)]),_:2},1024))),128))])):_("",!0)])]}),_:1})]),_:1,__:[10]})]),_:1})]),_:1})]),_:1})],64)}}};export{se as default};
