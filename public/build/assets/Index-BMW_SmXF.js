import{a as H,c as $,r as p,b as m,d as b,o as v,e as n,u as J,g as Q,w as o,f as x,h as w,i as t,j as s,t as r,F as S,k as W,l as A}from"./app-z_qK7d6H.js";import{A as X}from"./AdminLayout-DDNgbf8P.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                    */const ee={class:"d-flex flex-wrap align-center justify-space-between mb-4"},le={class:"d-flex flex-wrap align-center justify-space-between mb-4 gap-3"},te={class:"d-flex gap-2"},ae={class:"text-center"},ne={class:"text-center"},oe={key:0},se={class:"text-h6 mb-2"},ie={class:"d-flex justify-end gap-2 mt-2"},re={__name:"Index",props:{agents:Array,counts:Object,filters:Object},setup(c){const U=c,F=H(),O=$(()=>{var l,e;return((e=(l=F.props.auth)==null?void 0:l.user)==null?void 0:e.role)??"agent"}),z=$(()=>["superadmin","admin"].includes(O.value)),u=p("all"),_=p(""),N=p(!1),f=p(!1),y=p(!1),k=p(!1),i=p({id:null,name:"",email:"",role:"Agent"}),E=$(()=>{let l=U.agents||[];if(u.value!=="all"&&(l=l.filter(e=>e.status===u.value)),_.value){const e=_.value.toLowerCase();l=l.filter(g=>g.name.toLowerCase().includes(e)||g.email.toLowerCase().includes(e))}return l});function D(){y.value=!1,i.value={id:null,name:"",email:"",role:"Agent"},f.value=!0}function I(l){y.value=!0,i.value={id:l.id,name:l.name,email:l.email,role:l.role==="admin"?"Admin":l.role==="supervisor"?"Supervisor":"Agent"},f.value=!0}function R(l){return l==="admin"?"deep-purple":l==="supervisor"?"green":"blue"}function M(l){return l==="online"?"green":l==="offline"?"grey":"orange"}async function P(l){confirm("Approve this agent?")&&(N.value=!0,await A.post(`/agents/${l}/approve`),window.location.reload())}async function q(){k.value=!0;try{y.value&&i.value.id?await A.put(`/agents/${i.value.id}`,i.value):await A.post("/agents",i.value),f.value=!1,window.location.reload()}finally{k.value=!1}}async function K(l){confirm(`Delete agent ${l.name}?`)&&(N.value=!0,await A.delete(`/agents/${l.id}`),window.location.reload())}return(l,e)=>{const g=m("v-alert"),d=m("v-btn"),C=m("v-text-field"),V=m("v-chip"),T=m("v-icon"),Y=m("v-table"),j=m("v-card"),h=m("v-select"),G=m("v-dialog");return v(),b(S,null,[n(J(Q),{title:"Agents"}),n(X,null,{title:o(()=>e[10]||(e[10]=[s("Agents")])),default:o(()=>{var B;return[(B=l.$page.props.flash)!=null&&B.password_generated?(v(),x(g,{key:0,type:"success",variant:"tonal",class:"mb-4",title:"New Agent Created"},{default:o(()=>[e[11]||(e[11]=t("strong",null,"Email:",-1)),s(" "+r(l.$page.props.flash.password_generated.email)+" ",1),e[12]||(e[12]=t("br",null,null,-1)),e[13]||(e[13]=t("strong",null,"Password:",-1)),s(" "+r(l.$page.props.flash.password_generated.password),1)]),_:1,__:[11,12,13]})):w("",!0),z.value?w("",!0):(v(),x(g,{key:1,type:"error",variant:"tonal",title:"Access Denied",class:"mb-4"},{default:o(()=>e[14]||(e[14]=[s(" You don't have permission to manage agents. ")])),_:1,__:[14]})),z.value?(v(),x(j,{key:2,class:"pa-4",elevation:"2"},{default:o(()=>[t("div",ee,[e[16]||(e[16]=t("div",null,[t("h3",{class:"text-h6 mb-1"},"Agents Management"),t("p",{class:"text-body-2 text-grey-darken-1"}," Kelola daftar agent customer service. ")],-1)),n(d,{color:"primary","prepend-icon":"mdi-account-plus",onClick:D},{default:o(()=>e[15]||(e[15]=[s(" Add Agent ")])),_:1,__:[15]})]),t("div",le,[t("div",te,[n(d,{size:"small",variant:u.value==="all"?"flat":"text",color:"primary",onClick:e[0]||(e[0]=a=>u.value="all")},{default:o(()=>[s(" All ("+r(c.counts.all??0)+") ",1)]),_:1},8,["variant"]),n(d,{size:"small",variant:u.value==="online"?"flat":"text",color:"green",onClick:e[1]||(e[1]=a=>u.value="online")},{default:o(()=>[s(" Online ("+r(c.counts.online??0)+") ",1)]),_:1},8,["variant"]),n(d,{size:"small",variant:u.value==="offline"?"flat":"text",color:"grey",onClick:e[2]||(e[2]=a=>u.value="offline")},{default:o(()=>[s(" Offline ("+r(c.counts.offline??0)+") ",1)]),_:1},8,["variant"]),n(d,{size:"small",variant:u.value==="pending"?"flat":"text",color:"orange",onClick:e[3]||(e[3]=a=>u.value="pending")},{default:o(()=>[s(" Pending ("+r(c.counts.pending??0)+") ",1)]),_:1},8,["variant"])]),n(C,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=a=>_.value=a),placeholder:"Search name or email...",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",style:{"max-width":"260px"}},null,8,["modelValue"])]),n(Y,{"fixed-header":"",height:"420px"},{default:o(()=>[e[20]||(e[20]=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Email"),t("th",null,"Role"),t("th",null,"Status"),t("th",{class:"text-center"},"Approval"),t("th",{class:"text-center"},"Action")])],-1)),t("tbody",null,[(v(!0),b(S,null,W(E.value,a=>(v(),b("tr",{key:a.id,class:"hover-card"},[t("td",null,r(a.name),1),t("td",null,r(a.email),1),t("td",null,[n(V,{size:"small",color:R(a.role),class:"text-white",variant:"flat"},{default:o(()=>[s(r(a.role),1)]),_:2},1032,["color"])]),t("td",null,[n(V,{size:"small",color:M(a.status),class:"text-white",variant:"flat"},{default:o(()=>[s(r(a.status),1)]),_:2},1032,["color"])]),t("td",ae,[a.approved_at?(v(),x(V,{key:1,size:"small",color:"blue",variant:"tonal"},{default:o(()=>[n(T,{start:"",size:"16"},{default:o(()=>e[17]||(e[17]=[s("mdi-shield-check")])),_:1,__:[17]}),e[18]||(e[18]=s(" Approved "))]),_:1,__:[18]})):(v(),x(d,{key:0,color:"green",icon:"mdi-check",size:"small",onClick:L=>P(a.id)},null,8,["onClick"]))]),t("td",ne,[n(d,{icon:"mdi-pencil",size:"small",variant:"text",onClick:L=>I(a)},null,8,["onClick"]),n(d,{icon:"mdi-delete",size:"small",color:"red",variant:"text",onClick:L=>K(a)},null,8,["onClick"])])]))),128)),E.value.length?w("",!0):(v(),b("tr",oe,e[19]||(e[19]=[t("td",{colspan:"6",class:"text-center text-grey pa-4"}," No agents found. ",-1)])))])]),_:1,__:[20]})]),_:1})):w("",!0),n(G,{modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=a=>f.value=a),"max-width":"480"},{default:o(()=>[n(j,{class:"pa-4"},{default:o(()=>[t("h3",se,r(y.value?"Edit Agent":"Add Agent"),1),n(C,{modelValue:i.value.name,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value.name=a),label:"Full Name",class:"mb-3"},null,8,["modelValue"]),n(C,{modelValue:i.value.email,"onUpdate:modelValue":e[6]||(e[6]=a=>i.value.email=a),label:"Email",class:"mb-3"},null,8,["modelValue"]),n(h,{modelValue:i.value.role,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value.role=a),items:["Admin","Supervisor","Agent"],label:"Role",class:"mb-4"},null,8,["modelValue"]),t("div",ie,[n(d,{variant:"text",onClick:e[8]||(e[8]=a=>f.value=!1)},{default:o(()=>e[21]||(e[21]=[s("Cancel")])),_:1,__:[21]}),n(d,{color:"primary",loading:k.value,onClick:q},{default:o(()=>e[22]||(e[22]=[s(" Save ")])),_:1,__:[22]},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])]}),_:1})],64)}}},pe=Z(re,[["__scopeId","data-v-d3bbb241"]]);export{pe as default};
